# üåä Marine Weather Sensor Integration for Home Assistant

<p align="center">
  <img src="https://raw.githubusercontent.com/cloudbr34k84/home-assistant-Open-Meteo-Marine-Weather/main/brands/marine_weather/logo.png" width="200">
</p>

## Overview

This custom integration fetches marine weather data from the [Open-Meteo Marine API](https://marine-api.open-meteo.com/v1/marine) and exposes it in Home Assistant as sensors.
It provides current wave and swell conditions for user-defined locations.

## Features

* **Current Marine Weather Data:** Wave height, swell height, direction, and period
* **Compass Conversion:** Converts degrees into compass points (e.g., N, NE, SW)
* **Multiple Locations:** Define as many surf spots as needed in YAML
* **Configurable Timezone:** Each location can use its own IANA timezone string
* **Throttled Updates:** API requests limited to every 30 minutes
* **Error Handling:** Logs HTTP, request, or JSON errors to the Home Assistant log

---

## Installation

### Option 1: Manual install

Copy the entire `marine_weather` folder (including `__init__.py`, `sensor.py`, `const.py`, `manifest.json`, and `logo.png`) into:

```
<config>/custom_components/marine_weather/
```

### Option 2: Install via HACS (Custom Repository)

1. Go to **HACS ‚Üí Integrations ‚Üí Custom Repositories**
2. Add the repo:

   ```
   https://github.com/cloudbr34k84/Open-Meteo-Marine-Weather
   ```

   **Type:** *Integration*
3. Click **Add**
4. Search for **Open Meteo Marine Weather** in HACS and install
5. Restart Home Assistant

### Post-install check

* Ensure `const.py` is present. This file defines `DOMAIN` and `API_URL`
* Without it, the integration will fail to load

---

## Configuration

You can configure the integration inline or using split YAML files.

### Option 1: Inline in `configuration.yaml`

```yaml
sensor:
  - platform: marine_weather
    locations:
      - name: "Alexandra Headlands"
        latitude: -26.6715
        longitude: 153.1006
        timezone: "Australia/Brisbane"
      - name: "Kings Beach"
        latitude: -26.8017
        longitude: 153.1426
        timezone: "Australia/Brisbane"
```

### Option 2: Split into separate files

‚ö†Ô∏è Use this only if your `configuration.yaml` includes:

```yaml
sensor: !include_dir_merge_list sensors
```

Then create `sensors/marine_weather.yaml`:

```yaml
- platform: marine_weather
  locations:
    - name: "Alexandra Headlands"
      latitude: -26.6715
      longitude: 153.1006
      timezone: "Australia/Brisbane"
    - name: "Kings Beach"
      latitude: -26.8017
      longitude: 153.1426
      timezone: "Australia/Brisbane"
```

Restart Home Assistant to apply changes.

---

## Usage

Each defined location creates one entity:

```
<Location Name> Current
```

Example: `Alexandra Headlands Current`

---

### Attributes include

* **`swell_wave_height` (m)**
  The vertical size of distant, organized swells (not local chop). Bigger swell = larger, more powerful surf.
* **`swell_wave_direction` (¬∞ and compass)**
  Direction the swell is coming from. Important for how it hits your coastline (e.g., east swell vs south swell).
* **`swell_wave_period` (s)**
  Time between swell waves. Longer period = more energy and better surf shape.
* **`swell_wave_peak_period` (s)**
  The dominant swell interval at the moment (the ‚Äústrongest‚Äù period in the mix).
* **`wave_height` (m)**
  Overall wave size at the location (includes local wind chop plus swell).
* **`wave_direction` (¬∞ and compass)**
  Direction the breaking waves are coming from at your spot.
* **`timezone`**
  The timezone used when fetching data. Matches what you set in YAML (e.g., `Australia/Sydney`).
* **`models`**
  Which forecast model the API used. Usually `"best_match"`.

---

### Understanding the Difference: Waves vs Swell

<p align="center">
  <img src="https://bluewatermiles.com/images/extras/waves/swell.webp" width="800">
</p>

**Waves (Wind Waves / Chop)**

* **Origin:** Generated by local winds blowing at that moment
* **Characteristics:** Short-period, messy, irregular tops
* **Direction:** Moves with the local wind
* **Example:** Whitecaps on a windy day

**Swell**

* **Origin:** Produced by large, distant storms that blow for long periods
* **Characteristics:** Long-period, smooth, rolling, and rhythmic
* **Distance:** Can travel thousands of kilometers before reaching your coast
* **Example:** Clean, powerful surf arriving days after a storm far offshore

**In summary:**
Local wind creates short, messy **waves**, while distant storms generate long, organized **swells**. Surf conditions are usually a combination of both ‚Äî the swell provides the main energy, while local wind waves (seas/chop) affect cleanliness and ride quality.

---

## Limitations

* **UI setup not supported.** YAML configuration only
* **Forecast sensors not implemented.** Only ‚Äúcurrent‚Äù data is available

---

## FAQ

* **Q: Why can‚Äôt I add this integration from the UI?**
A: This integration does not include a config flow. It must be configured via YAML.

* **Q: My timezone shows as `Australia/Sydney`, but I‚Äôm in Europe. Why?**
A: Use the `timezone:` option in YAML for each location. Use a valid IANA timezone (e.g., `Europe/Madrid`).

* **Q: I get ‚ÄúNo module named const‚Äù?**
A: Make sure `const.py` is inside `custom_components/marine_weather/`.

* **Q: Can I define locations in multiple YAML files?**
A: Yes. Use `!include_dir_merge_list sensors` in `configuration.yaml` and create a separate `marine_weather.yaml`.

---

## Troubleshooting

* **Error: `No module named custom_components.marine_weather.const`**
  ‚Üí Ensure `const.py` exists in the same folder as `sensor.py`

* **Wrong timezone in attributes**
  ‚Üí Check that your YAML includes a valid IANA timezone string (e.g., `Europe/Madrid`)

* **Entities not showing**
  ‚Üí Verify YAML syntax, run *Check Configuration* in Developer Tools, then restart Home Assistant

---

## Support

* Post issues or feature requests on the [GitHub repository](https://github.com/cloudbr34k84/Open-Meteo-Marine-Weather)

---

